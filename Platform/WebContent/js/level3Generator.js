/**
 * 
 */


function generateLevel3(){
	 floorTexture = textureArray['darkWood'];
	  roofTexture = textureArray['marble1'];
	  wallTexture = textureArray['marble2'];
	generateLevel3Floors();
	 var ambientLight = new THREE.AmbientLight(0xffffff);
	    scene.add(ambientLight);
}


var UNITSIZE = 3;
var WALLHEIGHT = 8;

function generateLevel3Floors(){
	var map =  [ // 1, 2, 3, 4, 5, 6, 7, 8, 9 10 11 12 13 14
	            [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2], // 0
	            [2, 2, 2, 1, 2, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2], // 1
	            [2, 9, 1, 1, 2, 8, 1, 2, 2, 2, 18, 0, 1, 0, 2, 1, 2], // 2
	            [2, 0, 2, 2, 2, 2, 2, 1, 3, 1, 2, 2, 0, 1, 2, 1, 2], // 3
	            [2, 0, 9, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 0, 2, 1, 2], // 4
	            [2, 0, 0, 1, 2, 1, 4, 4, 4, 4, 4, 1, 2, 1, 0, 1, 2], // 5
	            [2, 0, 0, 2, 1, 1, 5, 4, 4, 4, 5, 1, 1, 2, 1, 1, 2], // 6
	            [2, 2, 0, 2, 1, 1, 4, 4, 6, 4, 4, 1, 1, 2, 1, 1, 2], // 7
	            [2, 9, 0, 2, 1, 1, 4, 5, 4, 4, 4, 1, 1, 2, 1, 1, 2], // 8
	            [2, 0, 0, 1, 2, 1, 4, 4, 4, 4, 5, 1, 2, 8, 1, 1, 2], // 8
	            [2, 0, 0, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2], // 8
	            [2, 0, 0, 1, 2, 1, 1, 1, 1, 1, 1, 2, 8, 2, 1, 1, 2], // 8
	            [2, 0, 0, 2, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2], // 8
	            [2, 0, 2, 1, 1, 1, 2, 2, 7, 2, 1, 1, 1, 1, 1, 2, 2], // 8
	            [2, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2], // 8
	            [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	           ]; 
	

	
//	var baseMap = [
//	               [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//		            [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
//	               ];
	
	var map2 =  [ // 1, 2, 3, 4, 5, 6, 7, 8, 9
	              [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	              [2, 1, 4, 1, 4, 4, 4, 1, 1, 2, 1, 8, 4, 4, 2, 12, 2], // 0
	              [2, 4, 4, 4, 4, 4, 4, 2, 1, 2, 4, 4, 4, 4, 2, 1, 2], // 1
	              [2, 4, 4, 4, 4, 4, 4, 2, 1, 2, 1, 4, 4, 1, 4, 4, 2], // 2
	              [2, 4, 4, 4, 1, 4, 1, 2, 0, 2, 4, 4, 4, 4, 4, 4, 2], // 3
	              [2, 4, 4, 4, 4, 4, 4, 2, 2, 2, 4, 4, 1, 4, 1, 4, 2], // 4
	              [2, 1, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 2], // 5
	              [2, 4, 4, 4, 4, 4, 1, 4, 4, 1, 4, 4, 4, 4, 4, 4, 2], // 6
	              [2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2], // 7
	              [2, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 2], // 8
	              [2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2], // 8
	              [2, 1, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2], // 8
	              [2, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 2], // 8
	              [2, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 1, 4, 4, 4, 4, 2], // 8
	              [2, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 2], // 8
	              [2, 4, 4, 4, 4, 4, 1, 4, 4, 1, 4, 4, 1, 4, 4, 4, 2], // 8
	              [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
		           ];
	
	
	//3 floors seems to be a bit intensive for the fps.
//	var map3 = [
//	            [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
//	            [2, 11, 1, 1, 1, 1, 1, 1, 1, 1, 1, 11, 1, 1, 11, 0, 2],
//	            [2, 1, 11, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 11, 1, 2],
//	            [2, 1, 1, 1, 1, 1, 11, 1, 1, 1, 1, 11, 1, 1, 11, 11, 2],
//	            [2, 1, 1, 11, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 11, 2],
//	            [2, 1, 1, 1, 1, 11, 1, 1, 11, 1, 1, 1, 11, 1, 11, 1, 2],
//	            [2, 1, 11, 1, 1, 1, 11, 1, 1, 1, 1, 11, 1, 11, 1, 1, 2],
//	            [2, 1, 11, 1, 11, 1, 1, 11, 1, 1, 1, 1, 1, 1, 11, 11, 2],
//	            [2, 11, 1, 1, 1, 11, 1, 1, 11, 1, 1, 1, 11, 1, 1, 1, 2],
//	            [2, 1, 1, 1, 1, 1, 1, 1, 1, 11, 1, 1, 1, 1, 1, 1, 2],
//	            [2, 1, 11, 1, 1, 1, 11, 1, 1, 1, 1, 1, 11, 1, 1, 1, 2],
//	            [2, 11, 1, 1, 1, 11, 1, 11, 1, 11, 11, 1, 1, 11, 1, 1, 2],
//	            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 11, 1, 1, 2],
//	            [2, 1, 11, 11, 1, 1, 1, 11, 1, 1, 1, 11, 1, 1, 1, 1, 2],
//	            [2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
//	            [2, 12, 11, 1, 11, 1, 1, 1, 11, 1, 1, 1, 1, 1, 11, 1, 2],
//	            [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
//	            ];
//	
//	var map4 = [
//    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 ,0 ,0 ,0 ,0, 2],
//     [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
//    ];
	
	
	maps = [];
	maps.push(map);
	maps.push(map2);
//	maps.push(map3);
//	maps.push(map4);
	doorNumber = 0;
	generateLevel(maps);
	
	THREE.Loader.Handlers.add(/\.dds$/i, new THREE.DDSLoader());
    var objLoader = new THREE.OBJMTLLoader();
	
	generateInvisibleWall();
	addPuzzleLever();
	
	
	
    
    objLoader.load('models/objects/key/key.obj', 'models/objects/key/key.mtl', keyLoadedCallback3);
    objLoader.load('models/objects/giant_door/giant_door.obj', 'models/objects/giant_door/giant_door.mtl', giantDoorLoadedCallback3);
    objLoader.load('models/objects/trap_spikes_ground/bloody/trap_spikes_ground_bloody.obj', 'models/objects/trap_spikes_ground/bloody/trap_spikes_ground_bloody.mtl', groundSpikesBloodyLoadedCallback3);
   
    loader = new THREE.JSONLoader();
    loader.load('models/objects/dung/dung.js', dung3LoadedCallback);
    scene.traverse(function(node) {
        if (node instanceof Physijs.BoxMesh) {
        	if(node.visible == true){
        		objects.push(node);
        	}
        }
    });
    
	level = 3;
	
	
}
